# BLE Tic-Tac-Toe Client for micro:bit

micro:bit を使って、Mac 上の Python サーバーと通信して遊ぶ三目並べ（Tic-Tac-Toe）ゲームのクライアントです。

## 目次 (Table of Contents)

- [BLE Tic-Tac-Toe Client for micro:bit](#ble-tic-tac-toe-client-for-microbit)
  - [目次 (Table of Contents)](#目次-table-of-contents)
  - [概要](#概要)
  - [必要なもの](#必要なもの)
  - [インストール方法](#インストール方法)
  - [遊び方](#遊び方)
    - [1. 起動と接続](#1-起動と接続)
    - [2. 先手・後手の選択](#2-先手後手の選択)
    - [3. ゲームプレイ](#3-ゲームプレイ)
    - [4. 結果表示](#4-結果表示)
    - [5. リセット](#5-リセット)
  - [サーバー側の準備](#サーバー側の準備)

## 概要

このプログラム (`main.ts`) は、micro:bit の LED マトリクスとボタンを使用して、三目並べのインターフェースを提供します。
ゲームのロジック（勝敗判定や AI の思考）はすべてサーバー側（Mac）で行われ、Bluetooth Low Energy (BLE) を介して通信します。

## デモ動画

実際のゲームプレイの様子です。

[デモ動画を再生 (MP4)](game_progression.mp4)


## 必要なもの

- **BBC micro:bit** (V1 または V2)
- **USBケーブル** (micro:bit と PC 接続用)
- **Mac** (Python サーバーを実行するため)
- **MakeCode エディタ** (Web ブラウザ版 または オフライン版)

## インストール方法

1.  [Microsoft MakeCode for micro:bit](https://makecode.microbit.org/) を開きます。
2.  「新しいプロジェクト」を作成します。
3.  **拡張機能** メニューを開き、`bluetooth` を検索して追加します（`radio` と競合する場合は `radio` を削除してください）。
4.  エディタを **JavaScript** (または TypeScript) モードに切り替えます。
5.  `main.ts` の内容をすべてコピーして、エディタに貼り付けます。
6.  「ダウンロード」ボタンを押して、生成された `.hex` ファイルを micro:bit に書き込みます。

## 遊び方

### 1. 起動と接続

micro:bit の電源を入れると、Bluetooth サービスが開始され、❤️ (ハート) アイコンが表示されます。
この状態で、Mac 上で[サーバープログラム](#サーバー側の準備)を実行して接続します。

接続が確立すると、✔️ (チェック) アイコンが表示され、その後メニュー画面に進みます。

### 2. 先手・後手の選択

画面に `?` が表示されます。

- **A ボタン**: 先手 (Player 1 / X) を選択。
- **B ボタン**: 後手 (Player 2 / O) を選択。

### 3. ゲームプレイ

ゲームが始まると、LED マトリクスの中央 3x3 が盤面になります。

- **点滅している点**: 現在のカーソル位置（あなたの選択候補）です。
- **明るく点灯**: `X` (Player 1)
- **薄く点灯**: `O` (Player 2)
- **消灯**: 空きマス

**操作**:
- **A ボタン**: カーソルを移動します（空いているマスのみを巡回します）。
- **B ボタン**: 現在のカーソル位置に手を打ちます（決定）。
    - 決定時、一瞬そのマスが強く点滅してフィードバックを返します。

### 4. 結果表示

勝負がつくと、以下のアイコンが表示されます。

- 🙂 (笑顔): 勝ち (WIN)
- 🙁 (悲しい顔): 負け (LOSE)
- 😕 (困った顔): 引き分け (DRAW)

もしあなたが勝った場合、最後に揃ったラインが点滅します。

### 5. リセット

- **A+B ボタン同時押し**: いつでもゲームをリセットして、先手・後手選択画面 (`?`) に戻ります。
- ゲーム終了後、**B ボタン** を押してもリセットできます。

## サーバー側の準備

このクライアントを使用するには、Mac 上で Python サーバーを実行する必要があります。

```bash
# プロジェクトのルートディレクトリで実行
python ble_server/main.py
```

**AI エージェントの変更**:
デフォルトではランダムに動く AI と対戦しますが、引数で変更可能です。

```bash
# Minimax (強い AI) と対戦する場合
python ble_server/main.py --agent Minimax
```
